---
title: "p8105_hw5_bf2506"
author: "bf2506"
date: "2022-11-15"
output: github_document
---
```{r load package, message=FALSE, warning=FALSE}
library(tidyverse)
```

### Problem 2

```{r read homi_data}
homi_data = 
  read.csv("./data/homicide-data.csv") %>%
  janitor::clean_names()
```
**Describe the raw data:**

* The dataset has `r ncol(homi_data)` variables and `r nrow(homi_data)` observations.

  * "uid"(the abbreviation of city - number); "reported_date"
  
  * "victim_last"(last name of victim); "victim_first"(first name of victim); "victim_race"; "victim_age"; "victim_sex"
  
  * "city"; "state"; "lat"(latitude); "lon"(longitude); 
  
  * "disposition": 
    * Closed by arrest when *police reported that to be the case*
    * Closed without arrest when *police reported that to be “exceptionally cleared.”* Those are cases in which there is sufficient evidence but an arrest is not possible, for example, if the suspect has died.
    * Open/No arrest: *All other cases* were classified as having no arrest.

##### Part A

Create a city_state variable and then summarize within cities to obtain the total number of homicides and the number of unsolved homicides.

```{r message=FALSE, warning=FALSE}
homi_data = 
  homi_data %>% 
  mutate(city_state = paste(city, state, sep = ", ", collapse = NULL)) 

total_df = 
  homi_data %>% 
  group_by(city) %>% 
  summarize(total_number_homicide = n())
total_df

unsolved_df = 
  homi_data %>% 
  filter(disposition != "Closed by arrest") %>% 
  group_by(city) %>% 
  summarize(number_unsolved_homicide = n())
unsolved_df  
```

##### Part B

For the city of Baltimore, MD, use the prop.test function to estimate the proportion of homicides that are unsolved; save the output of prop.test as an R object, apply the broom::tidy to this object and pull the estimated proportion and confidence intervals from the resulting tidy dataframe.

```{r message=FALSE, warning=FALSE}
balt_prop = 
  prop.test(1825, 2827, p = NULL, 
            alternative = "two.sided",conf.level = 0.95, correct = TRUE)
balt_prop

balt_prop_tibble = broom::tidy(balt_prop)
balt_prop_tibble

balt_prop_tibble %>% pull(estimate)
balt_prop_tibble %>% pull(conf.low)
balt_prop_tibble %>% pull(conf.high)
```

##### Part C

